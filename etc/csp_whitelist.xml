<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * Copyright Â© Lyra Network.
 * This file is part of PayZen plugin for Magento 2. See COPYING.md for license details.
 *
 * @author    Lyra Network (https://www.lyra.com/)
 * @author    eBusiness Atlantique
 * @copyright Lyra Network and contributors
 * @license   https://opensource.org/licenses/osl-3.0.php Open Software License (OSL 3.0)
 */
-->

<csp_whitelist xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
               xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Csp:etc/csp_whitelist.xsd">
    <policies>
        <policy id="script-src">
            <values>
                <value id="payzen_rest_api" type="host">https://api.payzen.eu/api-payment/</value>
                <value id="payzen_rest_static_ressources" type="host">https://static.payzen.eu/static/</value>
                <value id="payzen_krypton_client" type="host">https://api.payzen.eu/static/js/krypton-client/</value>
            </values>
        </policy>
        <policy id="img-src">
            <values>
                <value id="payzen_logo_url" type="host">https://secure.payzen.eu/static/latest/images/type-carte/</value>
                <value id="payzen_rest_static_ressources" type="host">https://static.payzen.eu/static/</value>
                <value id="payzen_gateway" type="host">https://secure.payzen.eu/vads-payment/</value>
                <value id="data_image" type="host">data:</value>
            </values>
        </policy>
        <policy id="style-src">
            <values>
                <value id="payzen_rest_static_ressources" type="host">https://static.payzen.eu/static/</value>
                <value id="payzen_krypton_client" type="host">https://api.payzen.eu/static/js/krypton-client/</value>
                <value id="payzen_font" type="host">https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap/</value>
            </values>
        </policy>
        <policy id="font-src">
            <values>
                <value id="payzen_rest_static_ressources" type="host">https://static.payzen.eu/static/</value>
            </values>
        </policy>
        <policy id="connect-src">
            <values>
                <value id="payzen_gateway" type="host">https://secure.payzen.eu/vads-payment/</value>
                <value id="payzen_rest_api" type="host">https://api.payzen.eu/api-payment/</value>
            </values>
        </policy>
        <policy id="frame-src">
            <values>
                <value id="payzen_gateway" type="host">https://secure.payzen.eu/vads-payment/</value>
                <value id="payzen_rest_static_ressources" type="host">https://static.payzen.eu/static/</value>
            </values>
        </policy>
        <policy id="form-action">
            <values>
                <value id="payzen_gateway" type="host">https://secure.payzen.eu/vads-payment/</value>
                <value id="payzen_rest_api" type="host">https://api.payzen.eu/api-payment/</value>
                <value id="payzen_rest_static_ressources" type="host">https://static.payzen.eu/static/</value>
            </values>
        </policy>
        <policy id="default-src">
            <values>
                <value id="payzen_gateway" type="host">https://secure.payzen.eu/vads-payment/</value>
                <value id="payzen_rest_api" type="host">https://api.payzen.eu/api-payment/</value>
                <value id="payzen_rest_static_ressources" type="host">https://static.payzen.eu/static/</value>
            </values>
        </policy>
    </policies>
</csp_whitelist>
